
      
<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            text-align: center;
            direction: rtl;
            background: #fff;
            color: #333;
            margin: 0;
            padding:0;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
 display:block;
        }
          img{
	margin:auto;
                width: 60%;
                border-radius: 15px;
                margin-top:20px;
                margin-bottom:20px;
	
          

          }
        .container {
          margin:auto;
            width: 90%;
            background: white;
            padding: 5px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.50);
        }
        input, select, button {
            width: 90%;
            margin: 10px;
            padding: 12px;
            font-size: 16px;
            border-radius: 5px;
            border: 1px solid #ddd;
            transition: 0.3s;
        }
        button {
            background: #5a9;
            color: white;
            border: none;
            cursor: pointer;
        }
        button:hover { background: #48a; }
        .hidden { display: none; }
   table{width:100%;}
    </style>
</head>
<body >
<div id="#img"> <img src="photo.jpg"></div>
  
    
    <!-- ØµÙØ­Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„ -->
    <div id="registerPage" class="container hidden">

        <h1>ØªØ³Ø¬ÙŠÙ„ Ø¬Ø¯ÙŠØ¯</h1>
        <input type="text" id="regName" placeholder="Ø§Ù„Ø§Ø³Ù…" onclick="checkAdminExists()">
        <input type="password" id="regPass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
        <input type="password" id="regPassConfirm" placeholder="ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
       <!-- <label><input type="checkbox" id="isAdmin"> ØªØ³Ø¬ÙŠÙ„ ÙƒÙ…Ø´Ø±Ù</label>-->
        <button onclick="register()">ØªØ³Ø¬ÙŠÙ„</button>
        <p>Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ <a href="#" onclick="showLogin()">Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„</a></p>
    </div>
    
    <!-- ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
    <div id="loginPage" class="container ">


        <h1>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h1>
        <input type="text" id="loginName" placeholder="Ø§Ù„Ø§Ø³Ù…">
        <input type="password" id="loginPass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
        <button onclick="login()">Ø¯Ø®ÙˆÙ„</button>
        <p>Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ <a href="#" onclick="showRegister()">Ø³Ø¬Ù„ Ø¬Ø¯ÙŠØ¯</a></p>
    </div>
    
    <!-- ØµÙØ­Ø© Ø§Ù„Ù…Ø´Ø±Ù -->
   <div id="adminPage" class="container hidden">
        <h2 id="welcomeMessage"></h2>
      
        <h3>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</h3>
        


        <!-- Ø²Ø± Ù„ÙØªØ­ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© -->
<button onclick="openUserManagement()">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</button>

<!-- Ù†Ø§ÙØ°Ø© Ù…Ù†Ø¨Ø«Ù‚Ø© Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† -->
<div id="userManagementModal" class="modal hidden">
    <div class="modal-content">
        <h2>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</h2>
        <table border="1" id="userTable">
            <thead>
                <tr>
                    <th>Ø§Ù„Ø§Ø³Ù…</th>
                    <th>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</th>
                    <th>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
        <button onclick="closeUserManagement()">Ø¥ØºÙ„Ø§Ù‚</button>
    </div>
</div>

<style>
    .modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .modal-content {
        background: white;
        padding: 20px;
        border-radius: 10px;
        width: 50%;
        text-align: center;
    }
    .hidden { display: none; }
</style>







        <h3>Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù…Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…</h3>
         <select id="userTaskSelect"></select>
        <input type="text" id="taskText" placeholder="Ø§Ù„Ù…Ù‡Ù…Ø©">
        <input type="text" id="positiveNote" placeholder="Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ø¥ÙŠØ¬Ø§Ø¨ÙŠØ©">
        <input type="text" id="negativeNote" placeholder="Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ø³Ù„Ø¨ÙŠØ©">
        <button onclick="addTask()">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù‡Ù…Ø©</button>
        <h3>Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ù‡Ø§Ù…</h3>
        <table border="1" id="taskTable">
            <thead>
                <tr>
                    <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                    <th>Ø§Ù„Ø§Ø³Ù…</th>
                    <th>Ø§Ù„Ù…Ù‡Ù…Ø©</th>
                    <th>Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ø¥ÙŠØ¬Ø§Ø¨ÙŠØ©</th>
                    <th>Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ø³Ù„Ø¨ÙŠØ©</th>
                    <th>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
       <button onclick="logout()">ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>
    </div>
    
    <!-- ØµÙØ­Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… -->
    <div id="userPage" class="container hidden">
        <h2 id="welcomeMessage2"></h2>
       
        <h3>Ù…Ù‡Ø§Ù…Ùƒ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</h3>
        <table border="1" id="userTaskTable">
            <thead>
                <tr>
                    <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                    <th>Ø§Ù„Ù…Ù‡Ù…Ø©</th>
                    <th>Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ø¥ÙŠØ¬Ø§Ø¨ÙŠØ©</th>
                    <th>Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ø³Ù„Ø¨ÙŠØ©</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
           <button onclick="logout()">ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>
    </div>
    
    <script>





                       


     async function loadUsersIntoSelect() {
            try {
                let response = await fetch("https://task-management-8q4e.onrender.com/users");
                let users = await response.json();
               
                let userTaskSelect = document.getElementById("userTaskSelect");
            
                userTaskSelect.innerHTML = "";
                
                users.forEach(user => {
                   
                    
                    let optionTask = document.createElement("option");
                    optionTask.value = user.name; 
                    optionTask.textContent = user.name;
                    userTaskSelect.appendChild(optionTask);
                });
            } catch (error) {
                console.error("âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†:", error);
            }
        }
        
      
            
  
    


    async function register() {
        let name = document.getElementById("regName").value.trim();
        let pass = document.getElementById("regPass").value.trim();
        let passConfirm = document.getElementById("regPassConfirm").value.trim();
        
        if (!name || !pass || pass !== passConfirm) {
            alert("âš ï¸ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­ ÙˆØ§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØªØ·Ø§Ø¨Ù‚ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±!");
            return;
        }

        let newUser = { name, password: pass, isAdmin: false }; // Ø§ÙØªØ±Ø§Ø¶ÙŠÙ‹Ø§ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ù„ÙŠØ³ÙˆØ§ Ù…Ø´Ø±ÙÙŠÙ†

        let response = await fetch("https://task-management-8q4e.onrender.com/users", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(newUser)
        });
	
           





        if (response.ok) {
            alert("âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ù†Ø¬Ø§Ø­! ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„.");
            showLogin();
        } else {
            alert("âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ³Ø¬ÙŠÙ„.");
        }
    }

    async function login() {
        let name = document.getElementById("loginName").value.trim();
        let pass = document.getElementById("loginPass").value.trim();

        try {
            let response = await fetch("https://task-management-8q4e.onrender.com/users");
            let users = await response.json();

            let user = users.find(user => user.name === name && user.password === pass);

            if (!user) {
                alert("âŒ Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± ØµØ­ÙŠØ­Ø©ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø§Ø³Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±.");
                return;
            }
            
            currentUser = user.name;
            console.log("ğŸ”¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ:", currentUser);
            
            if (user.isAdmin) {
               /* alert(`ğŸ”¹ Ù…Ø±Ø­Ø¨Ù‹Ø§ ${name}! Ù„Ù‚Ø¯ Ø³Ø¬Ù„Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒÙ…Ø´Ø±Ù.`);*/
	 document.getElementById("welcomeMessage").textContent = `Ù…Ø±Ø­Ø¨Ù‹Ø§ ${name}!`;
                showAdmin();
            } else {
                /*alert(`ğŸ‘‹ Ù…Ø±Ø­Ø¨Ù‹Ø§ ${name}! Ù„Ù‚Ø¯ Ø³Ø¬Ù„Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒÙ…Ø³ØªØ®Ø¯Ù… Ø¹Ø§Ø¯ÙŠ.`);*/
            document.getElementById("welcomeMessage2").textContent = `Ù…Ø±Ø­Ø¨Ù‹Ø§ ${name}!`;
                showUser();
            }
        } catch (error) {
            console.error("âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„:", error);
            alert("âŒ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù….");
        }
    }

   async function addTask() {
  let user = document.getElementById("userTaskSelect").value;
    let task = document.getElementById("taskText").value;
    let positiveNote = document.getElementById("positiveNote").value;
    let negativeNote = document.getElementById("negativeNote").value;
    let newTask = { user, task, positiveNote, negativeNote, date: new Date().toISOString().split('T')[0] };

    let response = await fetch("https://task-management-8q4e.onrender.com/tasks", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(newTask)
    });

    if (response.ok) {
        loadTasks();
    }
}

    async function loadTasks() {
        let response = await fetch("https://task-management-8q4e.onrender.com/tasks");
        let tasks = await response.json();
        let tableBody = document.querySelector("#taskTable tbody");
        tableBody.innerHTML = tasks.map((task, index) => `
            <tr>
                <td>${task.date}</td>
                <td>${task.user}</td>
                <td>${task.task}</td>
                <td>${task.positiveNote}</td>
                <td>${task.negativeNote}</td>
                <td>
                    <button onclick="deleteTask('${task.id}')">Ø­Ø°Ù</button>
                </td>
            </tr>
        `).join('');
    }

    async function deleteTask(taskId) {
        await fetch(`https://task-management-8q4e.onrender.com/tasks/${taskId}`, { method: "DELETE" });
        loadTasks();
    }

    function showLogin() {
        document.getElementById("registerPage").classList.add("hidden");
        document.getElementById("loginPage").classList.remove("hidden");
    }

    function showRegister() {
        document.getElementById("registerPage").classList.remove("hidden");
        document.getElementById("loginPage").classList.add("hidden");
    }

    function showAdmin() {
        document.getElementById("loginPage").classList.add("hidden");
        document.getElementById("adminPage").classList.remove("hidden");
        
        loadUsersIntoSelect();
        loadTasks();
    }


    async function openUserManagement() {
    let response = await fetch("https://task-management-8q4e.onrender.com/users");
    let users = await response.json();

    let tableBody = document.querySelector("#userTable tbody");
    tableBody.innerHTML = "";

    users.forEach((user, index) => {
        let row = document.createElement("tr");

        let nameCell = document.createElement("td");
        let nameInput = document.createElement("input");
        nameInput.value = user.name;
        nameCell.appendChild(nameInput);

        let passCell = document.createElement("td");
        let passInput = document.createElement("input");
        passInput.value = user.password;
        passInput.type = "password";
        passCell.appendChild(passInput);

        let actionsCell = document.createElement("td");
        let saveButton = document.createElement("button");
        saveButton.textContent = "ğŸ’¾ Ø­ÙØ¸";
        saveButton.onclick = () => updateUser(index, nameInput.value, passInput.value);

        let deleteButton = document.createElement("button");
        deleteButton.textContent = "ğŸ—‘ Ø­Ø°Ù";
        deleteButton.onclick = () => deleteUser(index);

        actionsCell.appendChild(saveButton);
        actionsCell.appendChild(deleteButton);

        row.appendChild(nameCell);
        row.appendChild(passCell);
        row.appendChild(actionsCell);
        tableBody.appendChild(row);
    });

    document.getElementById("userManagementModal").classList.remove("hidden");
}

function closeUserManagement() {
    document.getElementById("userManagementModal").classList.add("hidden");
}

async function updateUser(index, newName, newPass) {
    let response = await fetch(`https://task-management-8q4e.onrender.com/users/${index}`, {
        method: "PUT",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ name: newName, password: newPass })
    });

    if (response.ok) {
        alert("âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ù†Ø¬Ø§Ø­!");
        openUserManagement();
    } else {
        alert("âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù….");
    }
}

async function deleteUser(index) {
    let response = await fetch(`https://task-management-8q4e.onrender.com/users/${index}`, { method: "DELETE" });

    if (response.ok) {
        alert("âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ù†Ø¬Ø§Ø­!");
        openUserManagement();
    } else {
        alert("âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù….");
    }
}



    function showUser() {
        document.getElementById("loginPage")?.classList.add("hidden");
        document.getElementById("userPage").classList.remove("hidden");
        setTimeout(loadUserTasks, 500);
    }

    async function loadUserTasks() {
        try {
            let response = await fetch("https://task-management-8q4e.onrender.com/tasks");
            let tasks = await response.json();
            let userTasks = tasks.filter(task => task.user === currentUser);
            
            let tableBody = document.querySelector("#userTaskTable tbody");
            tableBody.innerHTML = userTasks.length > 0 ? userTasks.map(task => `
                <tr>
                    <td>${task.date}</td>
                    <td>${task.task}</td>
                    <td>${task.positiveNote}</td>
                    <td>${task.negativeNote}</td>
                </tr>
            `).join('') : "<tr><td colspan='4'>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‡Ø§Ù… Ø­Ø§Ù„ÙŠÙ‹Ø§</td></tr>";
        } catch (error) {
            console.error("âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù‡Ø§Ù…:", error);
        }
    }

    function logout() { location.reload(); }

    window.onload = function() {
       loadUsersIntoSelect();
            loadTasks();
      
    };


    </script>
</body>
</html>
